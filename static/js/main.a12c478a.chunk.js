(this.webpackJsonpdiary=this.webpackJsonpdiary||[]).push([[0],{160:function(e,t,a){e.exports=a.p+"static/media/profileImg.dbfa8ea2.png"},166:function(e,t,a){e.exports=a.p+"static/media/addProfileImg.0cc96624.png"},167:function(e,t,a){e.exports=a.p+"static/media/add-image.9df848b4.png"},168:function(e,t,a){e.exports=a(286)},173:function(e,t,a){},175:function(e,t,a){},176:function(e,t,a){},182:function(e,t){},184:function(e,t){},220:function(e,t){},221:function(e,t){},284:function(e,t,a){},285:function(e,t,a){},286:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(159),s=a.n(o),c=(a(173),a(12)),l=a(13),i=a(14),u=a(16),p=a(3),m=a.n(p),d=a(11),h=a(31),f=function(){var e=Object(d.a)(m.a.mark((function e(t){var a,n,r,o,s,c=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.length>1&&void 0!==c[1]?c[1]:"GET",n=c.length>2&&void 0!==c[2]?c[2]:void 0,r=c.length>3?c[3]:void 0,e.prev=3,e.next=6,fetch(t,Object(h.a)({method:a,headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"}},n&&{body:JSON.stringify(n)}));case 6:if((o=e.sent).ok){e.next=9;break}throw o.status;case 9:return e.next=11,o.json();case 11:return s=e.sent,e.abrupt("return",s);case 15:throw e.prev=15,e.t0=e.catch(3),e.t0;case 18:case"end":return e.stop()}}),e,null,[[3,15]])})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(d.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f("http://localhost:8000/post/list");case 3:return t=e.sent,e.abrupt("return",t);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),g=function(){var e=Object(d.a)(m.a.mark((function e(t,a){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f("http://localhost:8000/user/data/".concat(a),"GET",void 0,t);case 3:return n=e.sent,e.abrupt("return",n);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,a){return e.apply(this,arguments)}}(),b=function(){var e=Object(d.a)(m.a.mark((function e(t,a){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f("http://localhost:8000/post/add","POST",a,t);case 3:e.sent,e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,a){return e.apply(this,arguments)}}(),E=function(){var e=Object(d.a)(m.a.mark((function e(t,a){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f("http://localhost:8000/post/".concat(a),"DELETE",void 0,t);case 3:e.sent,e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,a){return e.apply(this,arguments)}}(),y=function(){var e=Object(d.a)(m.a.mark((function e(t,a){var n,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={username:t,password:a},e.next=4,f("http://localhost:8000/auth/signin","POST",n);case 4:return r=e.sent,e.abrupt("return",r);case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a){return e.apply(this,arguments)}}(),O=(a(175),a(160)),w=a.n(O),N=a(21);function k(e,t){var a=new Date;a.setTime(a.getTime()+6048e5);var n="".concat(e,"=").concat(t,";path=/;expires=").concat(a.toUTCString(),";");document.cookie=n}function j(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"action",t="; "+document.cookie,a=t.split("; "+e+"=");if(2===a.length)return a.pop().split(";").shift()}a(176);var x=a(110),P=a(88),I=P.a().shape({username:P.b().required("Username is required"),password:P.b().required("Password is required")}),S=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).handleSubmit=function(){var t=Object(d.a)(m.a.mark((function t(a){var n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,y(a.username,a.password);case 3:n=t.sent,k("token",n.token),e.props.history.push("/profile/".concat(a.username)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}(),e}return Object(l.a)(a,[{key:"render",value:function(){var e=this;return console.log(this.props),r.a.createElement("div",{className:"modalWindowLogInWrapper"},r.a.createElement("div",{className:"modalWindowLogIn"},r.a.createElement("div",{className:"modalWindowLogInContentWrapper"},r.a.createElement(x.b,{initialValues:{username:"",password:""},validationSchema:I,onSubmit:this.handleSubmit,validateOnBlur:!1,validateOnChange:!1},(function(t){var a=t.errors,n=(t.touched,t.values),o=t.handleSubmit,s=t.handleChange;return console.log(a),r.a.createElement(x.a,{className:"modalWindowForm",onSubmit:o},r.a.createElement("span",{className:"modalWindowLogInText"},"Please, log in"),r.a.createElement("input",{className:"modalWindowLogInInput",placeholder:"Username",name:"username",value:n.username,onChange:s}),r.a.createElement("input",{className:"modalWindowLogInInput",placeholder:"Password",type:"password",name:"password",value:n.password,onChange:s}),a.username&&r.a.createElement("div",{className:"modalWindowError"},a.username),a.password&&r.a.createElement("div",{className:"modalWindowError"},a.password),r.a.createElement("a",{className:"modalWindowLogInSignUp"},"Not registrated yet? Sign up now!"),r.a.createElement("div",{className:"modalWindowLogInButtonsWrapper"},r.a.createElement("div",{className:"modalWindowLogInCloseButton",onClick:e.props.closeLogInModal},"Close"),r.a.createElement("button",{className:"modalWindowLogInButton",type:"submit"},"Log in")))})))))}}]),a}(r.a.Component),C=a(83),L=a.n(C),W=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={posts:[],isAuthorized:!1,limit:3,isOpenRequireLogInModal:!1,username:""},e.closeLogInModal=function(){e.setState({isOpenRequireLogInModal:!1})},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(d.a)(m.a.mark((function e(){var t,a,n,r,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v();case 2:t=e.sent,a=j("token"),this.setState({isAuthorized:!!a,posts:t}),a&&(n=L.a.decode(a)||{},r=n.username,o=void 0===r?"":r,this.setState({username:o}));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return console.log(this.state),r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"homeHeader"},r.a.createElement("div",{className:"homeHeader"},r.a.createElement("span",{className:"homeHeaderElement"},"Diary"),this.state.isAuthorized?r.a.createElement(N.b,{to:"/profile/".concat(this.state.username),className:"homeHeaderProfileWrapper"},r.a.createElement("img",{className:"profileButtonImg",src:w.a}),r.a.createElement("span",{className:"homeHeaderElement"},"Profile")):r.a.createElement("div",{className:"homeHeaderElement",onClick:function(){e.setState({isOpenRequireLogInModal:!0})}},"Log in"))),r.a.createElement("section",{id:"HomePage"},r.a.createElement("div",{className:"postsWrapper"},this.state.posts.map((function(e,t){return r.a.createElement("div",{key:t,className:"post"},r.a.createElement("h2",{className:"postTitle"},e.title),r.a.createElement("p",null,e.text),r.a.createElement("img",{className:"postImage",src:e.image_uri}),r.a.createElement(N.b,{to:"/profile/".concat(e.author.username),className:"postAuthor"},e.author.username))}))),r.a.createElement("div",{className:"showMoreButtonWrapper"},r.a.createElement("button",{className:"showMoreButton",onClick:function(){e.state.isAuthorized?e.setState({limit:e.state.limit+6}):e.setState({isOpenRequireLogInModal:!0})}},"Show More")),this.state.isOpenRequireLogInModal&&r.a.createElement(S,{closeLogInModal:this.closeLogInModal,history:this.props.history})))}}]),a}(r.a.Component),B=(a(284),a(165)),A=a.n(B),R=a(166),U=a.n(R);function M(){return(M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function T(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var z=r.a.createElement("path",{d:"m232.398438 154.703125c-5.523438 0-10 4.476563-10 10v189c0 5.519531 4.476562 10 10 10 5.523437 0 10-4.480469 10-10v-189c0-5.523437-4.476563-10-10-10zm0 0"}),q=r.a.createElement("path",{d:"m114.398438 154.703125c-5.523438 0-10 4.476563-10 10v189c0 5.519531 4.476562 10 10 10 5.523437 0 10-4.480469 10-10v-189c0-5.523437-4.476563-10-10-10zm0 0"}),D=r.a.createElement("path",{d:"m28.398438 127.121094v246.378906c0 14.5625 5.339843 28.238281 14.667968 38.050781 9.285156 9.839844 22.207032 15.425781 35.730469 15.449219h189.203125c13.527344-.023438 26.449219-5.609375 35.730469-15.449219 9.328125-9.8125 14.667969-23.488281 14.667969-38.050781v-246.378906c18.542968-4.921875 30.558593-22.835938 28.078124-41.863282-2.484374-19.023437-18.691406-33.253906-37.878906-33.257812h-51.199218v-12.5c.058593-10.511719-4.097657-20.605469-11.539063-28.03125-7.441406-7.421875-17.550781-11.5546875-28.0625-11.46875h-88.796875c-10.511719-.0859375-20.621094 4.046875-28.0625 11.46875-7.441406 7.425781-11.597656 17.519531-11.539062 28.03125v12.5h-51.199219c-19.1875.003906-35.394531 14.234375-37.878907 33.257812-2.480468 19.027344 9.535157 36.941407 28.078126 41.863282zm239.601562 279.878906h-189.203125c-17.097656 0-30.398437-14.6875-30.398437-33.5v-245.5h250v245.5c0 18.8125-13.300782 33.5-30.398438 33.5zm-158.601562-367.5c-.066407-5.207031 1.980468-10.21875 5.675781-13.894531 3.691406-3.675781 8.714843-5.695313 13.925781-5.605469h88.796875c5.210937-.089844 10.234375 1.929688 13.925781 5.605469 3.695313 3.671875 5.742188 8.6875 5.675782 13.894531v12.5h-128zm-71.199219 32.5h270.398437c9.941406 0 18 8.058594 18 18s-8.058594 18-18 18h-270.398437c-9.941407 0-18-8.058594-18-18s8.058593-18 18-18zm0 0"}),F=r.a.createElement("path",{d:"m173.398438 154.703125c-5.523438 0-10 4.476563-10 10v189c0 5.519531 4.476562 10 10 10 5.523437 0 10-4.480469 10-10v-189c0-5.523437-4.476563-10-10-10zm0 0"}),H=function(e){var t=e.svgRef,a=e.title,n=T(e,["svgRef","title"]);return r.a.createElement("svg",M({height:"15pt",viewBox:"-40 0 427 427.00131",width:"15pt",fill:"white",ref:t},n),a?r.a.createElement("title",null,a):null,z,q,D,F)},V=r.a.forwardRef((function(e,t){return r.a.createElement(H,M({svgRef:t},e))})),_=(a.p,function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={posts:[],profile:{username:"",bio:"",profileImage:null}},e.getData=Object(d.a)(m.a.mark((function t(){var a,n,r,o,s;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=j("token"),n=e.props.match.params.username,t.next=5,g(a,n);case 5:r=t.sent,o=r.posts,s=r.profile,e.setState({posts:o,profile:s}),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.log({error:t.t0});case 14:case"end":return t.stop()}}),t,null,[[0,11]])}))),e.changeProfileImg=function(t){var a=t.target.files,n=new FileReader;n.readAsDataURL(a[0]),n.onload=function(t){e.setState(Object(h.a)({},e.state,{profile:Object(h.a)({},e.state.profile,{profileImage:t.target.result})}))}},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.getData()}},{key:"render",value:function(){var e=this;return console.log(this.state),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"profilePage"},r.a.createElement("div",{className:"profileHeader"},r.a.createElement(N.b,{to:"/",className:"profileHomeButton"},"Home"),r.a.createElement(N.b,{to:"/add-post",className:"profileAddPostButton"},r.a.createElement("div",{className:"addPostButon"},r.a.createElement("button",{className:"icon-btn add-btn"},r.a.createElement("div",{className:"add-icon"}),r.a.createElement("div",{className:"btn-txt"},"Add post"))))),r.a.createElement("div",{className:"profileFeedWrapper"},r.a.createElement("section",{className:"profileFeed"},r.a.createElement("div",{className:"profileInfo"},r.a.createElement("label",{title:"upload new image",htmlFor:"profileUpload",className:"profileImg",style:null==this.state.profile.profileImage?{content:"url(".concat(U.a,")")}:{content:"url(".concat(this.state.profile.profileImage,")")}},"Upload"),r.a.createElement("input",{id:"profileUpload",type:"file",onChange:function(t){e.changeProfileImg(t)}}),r.a.createElement("div",{className:"profileUserName"},this.state.profile.username),r.a.createElement("div",{className:"profileUserBio"},"Say no to good manners")),r.a.createElement("div",{className:"profilePosts"},this.state.posts.map((function(e){return console.log(e),r.a.createElement("div",{className:"userPost"},r.a.createElement("div",{className:"userPostTitle"},e.title),r.a.createElement("div",{className:"userPostText"},e.text),r.a.createElement("div",{className:"userPostBottomWrapper"},r.a.createElement("div",{className:"userPostLikes"},"Likes"),r.a.createElement("div",{className:"userPostBottomSection"},r.a.createElement("div",{className:"userPostCreatedAt"},A()(e.created_at).startOf("day").fromNow()),r.a.createElement("div",{className:"userPostSettings"},r.a.createElement(V,{onClick:function(){var t=j("token");E(t,e.id)}})))))})))))))}}]),a}(r.a.Component));a(285);function J(){return(J=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function G(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var K=r.a.createElement("path",{d:"M6 6c0-3.311 2.689-6 6-6s6 2.688 6 6v4h3v14h-18v-14h3v-4zm14 5h-16v12h16v-12zm-13-5v4h10v-4c0-2.76-2.24-5-5-5s-5 2.24-5 5z"}),Q=function(e){var t=e.svgRef,a=e.title,n=G(e,["svgRef","title"]);return r.a.createElement("svg",J({width:20,height:20,fill:"white",viewBox:"0 0 24 24",fillRule:"evenodd",clipRule:"evenodd",ref:t},n),a?r.a.createElement("title",null,a):null,K)},X=r.a.forwardRef((function(e,t){return r.a.createElement(Q,J({svgRef:t},e))})),Y=(a.p,a(167)),Z=a.n(Y),$=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={post:{title:"",text:"",isAnonym:!1,created_at:new Date,updated_at:new Date},lockColor:"",fileUpload:!1,username:""},e.handleTitleValue=function(t){e.setState({post:Object(h.a)({},e.state.post,{title:t.target.value})})},e.handleTextValue=function(t){e.setState({post:Object(h.a)({},e.state.post,{text:t.target.value})})},e.handlePublishPostRequest=Object(d.a)(m.a.mark((function t(){var a,n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.props.history,t.prev=1,n=j("token"),t.next=5,b(n,e.state.post);case 5:a.push("/profile/".concat(e.state.username)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])}))),e.handleLock=function(){""===e.state.lockColor?e.setState({lockColor:"#009688ba",post:Object(h.a)({},e.state.post,{isAnonym:!0})}):e.setState({lockColor:"",post:Object(h.a)({},e.state.post,{isAnonym:!1})})},e.handleUploadVisibility=function(){e.setState({fileUpload:!e.state.fileUpload})},e.handleFileUpload=function(e){var t=e.target.files,a=new FileReader;a.readAsDataURL(t[0]),a.onload=function(e){console.log(e.target.result)}},e}return Object(l.a)(a,[{key:"componentWillMount",value:function(){var e=j("token"),t=L.a.decode(e).username;this.setState({username:t})}},{key:"render",value:function(){var e=this;return console.log(this.state),r.a.createElement("div",{className:"addPostPage"},r.a.createElement("div",{className:"addPostWrapper"},r.a.createElement("input",{className:"addPostTitle",placeholder:"Add title",onChange:this.handleTitleValue}),r.a.createElement("textarea",{className:"postBody",placeholder:"Add text",onChange:this.handleTextValue}),r.a.createElement("div",{className:"addPostBottomSection"},r.a.createElement("div",{className:"addPostOptionsWrapper"},r.a.createElement("div",{title:"add image"},r.a.createElement("img",{className:"addPostAddImage",src:Z.a,onClick:this.handleUploadVisibility})),r.a.createElement("div",{title:"make private",className:"addPostLockWrapper",style:{backgroundColor:this.state.lockColor},onClick:this.handleLock},r.a.createElement(X,null))),r.a.createElement("div",{className:"addPostButtonWrapper"},r.a.createElement(N.b,{to:"/profile/".concat(this.state.username),className:"addPostCancelButton"},"Cancel"),r.a.createElement("button",{className:"addPostPublishButton",onClick:this.handlePublishPostRequest},"Publish"))),this.state.fileUpload&&r.a.createElement("input",{type:"file",name:"file",onChange:function(t){e.handleFileUpload(t)}})))}}]),a}(r.a.Component),ee=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,"Settings")}}]),a}(r.a.Component),te=a(45),ae=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"componentWillMount",value:function(){if(!j("token"))return this.props.history.push("/")}},{key:"render",value:function(){var e=this.props.component;return r.a.createElement(e,this.props)}}]),a}(r.a.Component),ne=Object(te.e)(ae),re=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement(te.c,null,r.a.createElement(te.a,{path:"/diary",exact:!0,component:W}),r.a.createElement(ne,{path:"/diary/settings",exact:!0,component:ee}),r.a.createElement(te.a,{path:"/diary/profile/:username",component:_,exact:!0}),r.a.createElement(ne,{path:"/diary/add-post",component:$,exact:!0}))}}]),a}(r.a.Component);s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(N.a,null,r.a.createElement(re,null))),document.getElementById("root"))}},[[168,1,2]]]);
//# sourceMappingURL=main.a12c478a.chunk.js.map